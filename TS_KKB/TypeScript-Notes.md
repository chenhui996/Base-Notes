# TypeScript

- 推荐用 vscode 进行编译:
  - 因为 vscode 是基于 typescript 进行编译的;
- 默认情况下，ts 文件的后缀是:
  - draft.ts

## 将 ts 文件转换成 js 文件

- 在命令行输入：

```
$tsc index.ts
```

- 然后，目录下即生成一个新的.js 结尾的文件;

### --outDir

- 指定编译文件输出目录:

```
$tsc --outDir ./dist ./ts_kkb/exp1.ts
```

- 执行后:
  - exp1.js 文件，将会在./dist 文件夹下生成;

### --target

- 指定编译的代码版本:
  - 默认为 ES3;
  - 所以要用--target 进行代码版本控制;

```
$tsc --outDir ./dist --target es5 ./ts_kkb/exp1/ts
```

- 这样，代码编译后，将是基于 es5 版本的 js 代码文件;

### --watch

- 在监听模式下运行:
  - 当文件发生改变时，自动进行编译:

```
$tsc --outDir ./dist --target es5 --watch ./ts_kkb/exp1/ts
```

- 自动：可以理解成类似 nodemon 的自动化;

## 编译配置文件

- 每次编译都调用那么长的命令，太繁琐，所以 tsc 支持我们进行————编译配置文件

### tsconfig.json

- 所有配置文件，都直接在此文件下进行配置， 然后编译成一个命令，统一执行;

```json
{
  "compilerOptions": {
    "outDir": "./dist",
    "target": "ES6",
    "watch": true
  },
  "include": ["./src/**/*"]
}
```

- include: 指定 ts 编译起效的目录;
- `**`: 所有目录(包括子目录);
- `*`: 所有文件，也可以指定类型文件;

- 配置完成后，只需要在命令行输入：
  - tsc，即可运行;

### --project

- 使用--project 或-p 指定配置文件目录;
  - 默认是加载该目录下的 tsconfig.json 文件;
- 若配置文件不叫 tsconfig.json:

```
tsc -p ./configs/ts.json
```

## 动态类型语言&静态类型语言

### 动态类型语言

- 程序'运行期间'才做数据类型检查的语言，如: JavaScript

### 静态类型语言

- 程序'编译期间'做数据类型检查的语言，如：Java

## 静态类型语言的优缺点

### 优点：

- 程序编译阶段(配合 IDE、编辑器甚至可以在编码阶段)：
  - 即可发现一些潜在错误;
  - 避免程序在'生产环境'运行了以后再出现错误;
- 编码规范、有利于团队开发协作、也更有利于大型项目开发、项目重构;
- 配合 IDE、编辑器提供更强大的代码智能提示/检查;
- 代码即文档;

### 缺点

- 麻烦;
- 缺少灵活性;

## 动态类型语言的优缺点

### 优点

- 静态类型语言的缺点;

### 缺点

- 静态类型语言的优点;

## 类型系统

- 类型系统包含两个重要的组成部分：
  - 类型标注(定义、注解) - typing;
  - 类型检测(检查) - type-checking;

### 类型标注

- 在代码中给'数据'添加类型说明:
  - 变量
  - 函数(参数、返回值)
- 当一个变量或函数(参数)等被标注以后：
  - 就'不能存储'或'传入'与'标注类型不符合'的'类型';
- 有了标注，TypeScript 编译器就能按照标注对这些数据进行类型合法检测;
- 有了标注，各种编辑器、IDE 等就能进行智能提示;

### 类型检测

- 对'类型'数据进行检测;
  - 注意，检查的是类型，不是值;
  - 值是业务层具体逻辑;

## 类型标注

- 在 ts 中，基本语法格式:
  - 数据载体: 类型;
- ts 的类型标注:
  - 基础的简单的类型标注;
  - 高级的深入的类型标注;

### null 和 undefind

- 是所有类型的子类型：
  - 所有类型的值，都可以设置为 null 和 undefind,不会报错;
- 所有未标注的对象的类型，都为 any;

### strictNullChecks

- 严格的空值检查字段;
- 写在 tsconfig.json 的配置项;
  - strictNullChecks:true

## 内置对象类型

### 对象标注

```ts
let a: Object = {};
```

### 数组标注

```ts
let arr: Array<number> = [1, 2, 3];
```

### 日期标注

```ts
let a: Date = new Date();
```

### 字面量标注：

- 对象内容若有属性：
  - 必须在声明变量名处'挨个'标注完整;

```ts
let a: { username: string; age: number } = {
  username: "cain",
  age: 100,
};
```

- 缺点：
  - 不太方便;
  - 不利于复用;
- 解决方案：
  - 用接口的形式:
    - 提高复用性;

### 接口

- 给类型定义名称;
- 只存在与源码和编译过程;
  - 最后通过 tsc 编译成 js 后，interface 是不存在的;
  - 是给编译器看的;

```ts
interface Person {
  username: string;
  age: number;
}

let a: Person = {
  username: "cain",
  age: 100,
};

let a1: Person = {
  username: "snake",
  age: 123131,
};
```

- 优点:
  - 复用性高;
- 缺点:
  - 接口只能作为类型标注使用;
    - 不能作为具体值;
    - 它只是一种抽象的结构定义,并不是实体;
      - 没有具体的功能实现;
- 解决方案：
  - 类与构造函数

### 类与构造函数

- 实现既能定义，又能引用;
- 与 interface 不同的是，编译后:
  - 约束参数结构的部分去除;
    - 只留类的构造函数的部分的;

```ts
class Person {
  // username: string
  constructor(public username: string, public age: number) {}
}

let user: Person = new Person("cain", 18);
```

- 用类的方式，就即能标注 user 对象，又能引用其构造函数;
- 优点：
  - 功能相对强大，定义实体的同时也定义了对应的类型;
- 缺点：
  - 复杂：
    - 比如只想约束某个函数'接收'的'参数结构';
    - 没有必要去定一个类;
    - 使用接口会更加简单(所以是根据需求，具体情况，具体分析);

### 包装对象

- 指的是 JS 中的:
  - String
  - Number
  - Boolean
- 我们知道，string 与 String 不一样;
- 在 ts 中也是如此;

```ts
// 错误的：
let a: string = new String("1");

// 正确的：
let b: String = new String("1");
b = "1";
```

- 原因：
  - 字符串有的，字符串对象一定有;
  - 字符串对象有的，字符串不一定有;
    - 会损失数据;

## 数组类型

- 数组是什么？
  - 一类具有相同特性的数据的有序集合;
  - 这里需要注意两个点:
    - 相同特性;
    - 有序的;
- 所以，引出的 ts 中的数组存储：
  - 数组存储的'类型必须一致';
    - 在标注数组类型时：
      - 同时要标注数组中存储的数据类型;

```ts
// 数字类型数组
let arr1: Array<number> = [1, 2, 3];

// 字符串类型数组
let arr2: string[] = ["a", "b", "c"];
```

- 但是若我硬是想在一个数组里面，添加多个类型的数据呢？咋搞？
  - 不多说————元组

## 元组类型

- 元组类似数组，但是存储的元素类型不必相同;
- 但是需要注意:
  - '初始化数据'的'个数'以及'对应位置'标注类型必须一致;
  - '越界数据'必须是'元组标注'中的'类型之一';
    - 标注越界数据可以不用对应顺序 - 联合类型

```js
// 初始化时注意：顺序、类型和数量，这3个点都必须对应;
let data: [string, number] = ["cain", 11];

// 初始化完成后，就可以正常添加元素了
// 正确的:
data.push(1);
data.push("aaa");

// 错误的:
data.push(true);
// 原因: 标注类型中'标注的数组data',未允许含有boolean类型的元素;
```
