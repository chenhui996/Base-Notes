# Jsonp

- 利用 Jsonp,解决跨域问题;

## 同源策略

- 为什么会出现跨域问题？
- 因为浏览器有一个"同源策略":
  - 同源策略是浏览器的一个安全功能;
  - 不同源的客户端脚本在：
    - 没有"明确授权"的情况下;
    - 不能读写对方资源
- 总结：
  - 简单来说，只要"客户端脚本"被"明确授权"，就可以跨域了;

### 源

- 前面提到'同源'、'不同源'，所以源的概念是？
- 源:
  - 协议: http、https、ftp、tcp/ip
  - 域名:
  - 端口号
- 所以，同源就是：
  - 协议、域名、端口号均一样;
  - 只要其中有一个不一样，就是'不同源'，也就是跨域;

#### http 与 https

- 两者都是 http 协议;
- https 是在 http 的基础上，进行了封装;
  - 目的：更为安全;

## Jsonp 原理

- 利用了 script 标签的特性，实现跨域:

```js
// 假设当前的端口是3000，你想请求4000端口
<script src="http://localhost:4000/getAiax"></script>
// 这样，是能成功的，因为这是script标签的特性，支持以这种方式进行跨域;
```

- 虽然可以实现，但是有问题:
  - 变量污染;
  - 由于 src 是固定的，query 的传递若是动态的，以后会变的，那就会出现问题;
  - 异步问题;
- 解决方法:
  - 动态创建 script 实现请求;

### 动态创建 script 实现请求

- 在一个 script 标签内部;
  - 用 createElement('script');
  - 创建一个 script;
    - 这样，src 就可以是动态的参数了;
  - 通过在服务端发回，在客户端定义的回调函数，实现异步处理;
- 至此，上述问题得到解决;
